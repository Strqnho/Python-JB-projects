import random

correct_inputs = ["rock", "paper", "scissors", "!exit", "!rating"]

user_name = input("Enter your name: ")
print(f"Hello, {user_name}!")

my_dict = {}

file = open("rating.txt", "r+")

for line in file:
    record = line.split()
    name = record[0]
    score = int(record[1])
    my_dict[name] = score

if user_name not in my_dict.keys():
    my_dict[user_name] = 0

file.close()


def play():
    while True:
        user_input = input()

        if user_input not in correct_inputs:
            print("Invalid input")
            play()

        if user_input == "!exit":
            print("Bye")
            new_file = open("rating.txt", "w")
            for k, v in my_dict.items():
                new_file.write(f"{k} {v}\n")
            new_file.close()
            exit()

        if user_input == "!rating":
            print(f'Your rating: {my_dict[user_name]}')
            play()

        comp_choice = random.choice(["rock", "paper", "scissors"])

        if user_input == "rock":
            if comp_choice == "paper":
                print(f"Sorry, but the computer chose {comp_choice}")

            elif comp_choice == "scissors":
                print(f"Well done. The computer chose {comp_choice} and failed")
                my_dict[user_name] += 100

            else:
                print(f"There is a draw {comp_choice}")
                my_dict[user_name] += 50

        elif user_input == "paper":
            if comp_choice == "scissors":
                print(f"Sorry, but the computer chose {comp_choice}")

            elif comp_choice == "rock":
                print(f"Well done. The computer chose {comp_choice} and failed")
                my_dict[user_name] += 100

            else:
                print(f"There is a draw {comp_choice}")
                my_dict[user_name] += 50

        elif user_input == "scissors":
            if comp_choice == "rock":
                print(f"Sorry, but the computer chose {comp_choice}")

            elif comp_choice == "paper":
                print(f"Well done. The computer chose {comp_choice} and failed")
                my_dict[user_name] += 100

            else:
                print(f"There is a draw {comp_choice}")
                my_dict[user_name] += 50


play()
